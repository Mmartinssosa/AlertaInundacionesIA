<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alerta Inundaciones IA - Tu Plataforma de Prevención en Almirante Brown</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" xintegrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Oswald:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
       // AOS.init({ duration: 1000 });
     </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0D1B2A; /* Azul oscuro principal */
            color: #E0E1DD; /* Texto claro */
        }
        .futuristic-bg {
            background-color: #1B263B; /* Azul oscuro secundario */
        }
        .accent-color {
            color: #3DCCC7; /* Turquesa acento */
        }
        .accent-bg {
            background-color: #3DCCC7;
            color: #0D1B2A;
        }
        .accent-border {
            border-color: #3DCCC7;
        }
        .card {
            background-color: #2A3B4D; /* Un poco más claro para cards */
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 30px -10px rgba(0, 0, 0, 0.4);
        }
        img:hover {
            transform: scale(1.05);
            transition: transform 0.3s ease;
        }
        .btn-primary {
            background-color: #3DCCC7;
            color: #0D1B2A;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }
        .btn-primary:hover {
            transform: scale(1.05);
        }
        .btn-secondary {
            background-color: transparent;
            color: #3DCCC7;
            border: 2px solid #3DCCC7;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 8px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: #3DCCC7;
            color: #0D1B2A;
        }
        .nav-link {
            color: #E0E1DD;
            transition: color 0.3s ease;
            padding: 8px 12px;
            border-radius: 6px;
        }
        .nav-link:hover, .nav-link.active {
            color: #3DCCC7;
            background-color: rgba(61, 204, 199, 0.1);
        }
        #map {
            height: 500px;
            border-radius: 12px;
            border: 2px solid #3DCCC7;
        }
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.6); /* Black w/ opacity */
        }
        .modal-content {
            background-color: #1B263B;
            margin: 10% auto; /* 10% from the top and centered */
            padding: 25px;
            border: 1px solid #3DCCC7;
            width: 80%; /* Could be more or less, depending on screen size */
            max-width: 500px;
            border-radius: 12px;
            text-align: center;
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close-button:hover,
        .close-button:focus {
            color: #E0E1DD;
            text-decoration: none;
            cursor: pointer;
        }
        /* Custom scrollbar for a more futuristic look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1B263B;
        }
        ::-webkit-scrollbar-thumb {
            background: #3DCCC7;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #2aa7a2;
        }
        /* Input field styling */
        input[type="text"], input[type="email"], input[type="tel"], textarea, select {
            background-color: #0D1B2A;
            border: 1px solid #3DCCC7;
            color: #E0E1DD;
            border-radius: 6px;
            padding: 10px;
            width: 100%;
            transition: border-color 0.3s ease;
        }
        input[type="text"]:focus, input[type="email"]:focus, input[type="tel"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #2aa7a2;
            box-shadow: 0 0 0 2px rgba(61, 204, 199, 0.3);
        }
        label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: block;
        }
    </style>
</head>
<body class="antialiased">

    <nav class="futuristic-bg p-4 fixed w-full z-50 shadow-lg top-0">
        <div class="container mx-auto flex justify-between items-center">
            <a href="#" class="text-2xl font-bold accent-color">
                <i class="fas fa-water"></i> AlertaInundaciones.IA
            </a>
            <div class="hidden md:flex space-x-2">
                <a href="#inicio" class="nav-link active">Inicio</a>
                <a href="#noticias" class="nav-link">Noticias</a>
                <a href="#mapa-alertas" class="nav-link">Mapa de Alertas</a>
                <a href="#reportar-inundacion-mapa" class="nav-link">Reportar</a>
                <a href="#pronostico" class="nav-link">Pronóstico</a>
                <a href="#predicciones" class="nav-link">Predicciones</a>
                <a href="#alerta-temprana" class="nav-link">Alerta Temprana</a>
                <a href="#preparacion" class="nav-link">Preparación</a>
                <a href="#concientizacion" class="nav-link">Concientización</a>
                <a href="#contacto" class="nav-link">Contacto</a>
            </div>
            <button id="mobileMenuButton" class="md:hidden text-2xl">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <div id="mobileMenu" class="hidden md:hidden futuristic-bg mt-2">
            <a href="#inicio" class="block nav-link text-center py-2">Inicio</a>
            <a href="#noticias" class="block nav-link text-center py-2">Noticias</a>
            <a href="#mapa-alertas" class="block nav-link text-center py-2">Mapa de Alertas</a>
            <a href="#reportar-inundacion-mapa" class="block nav-link text-center py-2">Reportar</a>
            <a href="#pronostico" class="block nav-link text-center py-2">Pronóstico</a>
            <a href="#predicciones" class="block nav-link text-center py-2">Predicciones</a>
            <a href="#alerta-temprana" class="block nav-link text-center py-2">Alerta Temprana</a>
            <a href="#preparacion" class="block nav-link text-center py-2">Preparación</a>
            <a href="#concientizacion" class="block nav-link text-center py-2">Concientización</a>
            <a href="#contacto" class="block nav-link text-center py-2">Contacto</a>
        </div>
    </nav>

    <header id="inicio" class="relative pt-24 md:pt-32 min-h-screen flex items-center justify-center overflow-hidden" data-aos="fade-up">
        <video autoplay muted loop playsinline class="absolute inset-0 w-full h-full object-cover opacity-50 z-0">
               <source src="https://media.istockphoto.com/id/1326174338/es/v%C3%ADdeo/coches-inundados-en-la-calle-de-la-ciudad-calle-tras-fuertes-lluvias-el-agua-podr%C3%ADa-entrar-en.mp4?s=mp4-640x640-is&k=20&c=siwKNOQhqgdhylA9PekzQAgOr_GeBpu2sG_cx0J95A0=" type="video/mp4">
               Tu navegador no soporta el video.
        </video>

        <div class="absolute inset-0 bg-black opacity-50 z-10"></div>

        <div class="container mx-auto text-center px-4 p-10 rounded-lg relative z-20">
            <h1 class="text-6xl md:text-8xl font-extrabold mb-6 accent-color">Alerta Inundaciones IA</h1>
            <p class="text-3xl md:text-4xl text-gray-300 leading-relaxed max-w-3xl mx-auto mt-4 mb-8"> Tu plataforma inteligente para la gestión y prevención de inundaciones en <span class="text-blue-400">Almirante Brown</span>.
            </p>

             <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-4 mt-8"> 
                 <a href="#mapa-alertas" class="btn-primary"> <i class="fas fa-map-marked-alt mr-2"></i> Ver Mapa de Alertas
                 </a>
                 <a href="#reportar-inundacion-mapa" class="btn-secondary"> <i class="fas fa-bullhorn mr-2"></i> Reportar Incidente
                 </a>
              </div>
         </div>
    </header>

    <section id="noticias" class="py-16 md:py-24 futuristic-bg" data-aos="fade-up">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Últimas <span class="accent-color">Noticias</span> sobre Inundaciones</h2>
            <div id="newsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="text-center p-4" id="newsLoading"><i class="fas fa-spinner fa-spin fa-3x accent-color"></i><p class="mt-2">Cargando noticias...</p></div>
            </div>
        </div>
    </section>

    <section id="mapa-alertas" class="py-16 md:py-24" data-aos="fade-up">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-6">Mapa Interactivo de <span class="accent-color">Alertas</span></h2>
            <p class="text-center mb-10 max-w-2xl mx-auto">Visualiza zonas frecuentemente inundables, reportes actuales y áreas de riesgo. Haz clic en los marcadores para más información.</p>
            <div id="map" class="shadow-2xl"></div>
            <div class="mt-8 text-center">
                <h3 class="text-xl font-semibold mb-2">Leyenda:</h3>
                <span class="inline-block mr-4"><i class="fas fa-circle text-red-500"></i> Zona de Alto Riesgo Frecuente</span>
                <span class="inline-block mr-4"><i class="fas fa-circle text-yellow-500"></i> Reporte Ciudadano Reciente</span>
                <span class="inline-block"><i class="fas fa-circle text-blue-500"></i> Punto de Interés (Refugio, etc.)</span>
            </div>
        </div>
    </section>

    <section id="reportar-inundacion-mapa" class="py-16 md:py-24 futuristic-bg" data-aos="fade-up">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Reportar <span class="accent-color">Inundación</span></h2>
            <div class="card p-8 max-w-2xl mx-auto">
                <p class="mb-6 text-center">Selecciona una ubicación en el mapa o búscalas, y proporciona los detalles del incidente.</p>

                <form id="floodReportForm" enctype="multipart/form-data" class="space-y-6">
                     <div class="mb-6">
                         <label for="reportLocationInput" class="block mb-2 text-sm font-medium">Busca o selecciona una ubicación <span class="text-red-500">*</span></label>
                         <input type="text" id="reportLocationInput" name="address" class="shadow-sm" placeholder="Ej: Calle Falsa 123, Ciudad" required>
                         <input type="hidden" id="reportLat" name="lat">
                         <input type="hidden" id="reportLng" name="lng">
                     </div>

                      <div id="reportMap" class="w-full h-80 bg-gray-200 rounded-lg shadow-inner mb-6"></div>

                      <div class="mb-6">
                         <label for="description" class="block mb-2 text-sm font-medium">Descripción de la Situación <span class="text-red-500">*</span></label>
                         <textarea id="description" name="description" rows="4" class="shadow-sm" placeholder="Agua cubriendo la calle, ingreso a viviendas, etc." required></textarea>
                     </div>

                      <div class="mb-6">
                         <label for="waterLevel" class="block mb-2 text-sm font-medium">Nivel Estimado del Agua</label>
                         <select id="waterLevel" name="water_level" class="shadow-sm">
                             <option value="">Seleccione una opción</option>
                             <option value="bajo">Bajo (cordón de la vereda)</option>
                             <option value="medio">Medio (cubre ruedas de autos)</option>
                             <option value="alto">Alto (ingreso a propiedades)</option>
                             <option value="muy_alto">Muy Alto (peligroso)</option>
                         </select>
                     </div>

                      <div class="mb-6">
                          <label for="reportImage" class="block mb-2 text-sm font-medium">Adjuntar Imagen (Opcional)</label>
                          <input type="file" id="reportImage" name="image" class="block w-full text-sm border border-gray-600 rounded-lg cursor-pointer focus:outline-none file:mr-4 file:py-2 file:px-4 file:rounded-l-lg file:border-0 file:text-sm file:font-semibold file:bg-gray-700 file:text-gray-300 hover:file:bg-gray-600">
                          <p class="mt-1 text-xs text-gray-400">Formatos permitidos: JPG, PNG. Tamaño máximo: 5MB.</p>
                     </div>

                     <button type="submit" class="btn-primary w-full">Enviar Reporte</button>
                     <div id="reportStatus" class="mt-4 text-center"></div>
                 </form>
             </div>
         </div>
    </section>

    <section id="pronostico" class="py-16 md:py-24" data-aos="fade-up">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Pronóstico del <span class="accent-color">Tiempo</span></h2>
            <div id="weatherContainer" class="max-w-3xl mx-auto card p-8 text-center">
                <div id="weatherLoading"><i class="fas fa-spinner fa-spin fa-2x accent-color"></i><p class="mt-2">Cargando pronóstico...</p></div>
            </div>
        </div>
    </section>

    <section id="predicciones" class="py-16 md:py-24 futuristic-bg" data-aos="fade-up">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Predicciones <span class="accent-color">IA</span> de Inundaciones</h2>
            <div id="predictionsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="card p-6" data-aos="zoom-in">
                    <h3 class="text-xl font-semibold mb-3 accent-color"><i class="fas fa-brain mr-2"></i>Análisis Predictivo Zona Norte</h3>
                    <p class="mb-2">Basado en modelos hidrológicos y meteorológicos, se estima un <strong class="text-yellow-400">riesgo moderado</strong> de anegamientos en las próximas 48 horas debido a lluvias intensas pronosticadas.</p>
                    <p class="text-sm text-gray-400">Última actualización: Hace 2 horas</p>
                </div>
                <div class="card p-6" data-aos="zoom-in">
                    <h3 class="text-xl font-semibold mb-3 accent-color"><i class="fas fa-chart-line mr-2"></i>Tendencia Histórica Cuenca Matanza-Riachuelo</h3>
                    <p class="mb-2">Los datos históricos y las condiciones actuales sugieren una <strong class="text-green-400">baja probabilidad</strong> de desbordes significativos en los próximos 7 días.</p>
                    <p class="text-sm text-gray-400">Última actualización: Hace 5 horas</p>
                </div>
                <div class="text-center p-4 md:col-span-2" id="predictionsLoading" style="display:none;"><i class="fas fa-spinner fa-spin fa-2x accent-color"></i><p class="mt-2">Cargando predicciones...</p></div>
            </div>
             <p class="text-center mt-8 text-gray-400 text-sm">Nota: Las predicciones son generadas por modelos de IA y deben usarse como una herramienta de apoyo, no como una garantía absoluta.</p>
        </div>
    </section>

    <section id="alerta-temprana" class="py-16 md:py-24" data-aos="fade-up">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Sistema de <span class="accent-color">Alerta Temprana</span></h2>
            <div id="earlyWarningContainer" class="max-w-3xl mx-auto">
                 <div class="card p-8 mb-6" data-aos="zoom-in">
                    <h3 class="text-2xl font-semibold mb-3 accent-color"><i class="fas fa-triangle-exclamation mr-2"></i> Alerta Amarilla por Tormentas - AMBA</h3>
                    <p class="mb-2">Se esperan tormentas fuertes con posible caída de granizo y ráfagas intensas para la tarde/noche de hoy. Posibles anegamientos temporarios en zonas vulnerables.</p>
                    <p class="text-sm text-gray-400">Emitida: Hoy, 10:00 AM - Fuente: Servicio Meteorológico Nacional</p>
                    <a href="#" class="text-sm accent-color hover:underline mt-3 inline-block">Más detalles <i class="fas fa-arrow-right text-xs"></i></a>
                </div>
                <div class="card p-8" data-aos="zoom-in">
                    <h3 class="text-2xl font-semibold mb-3"><i class="fas fa-info-circle mr-2"></i> Sin Alertas Activas - Región Litoral</h3>
                    <p class="mb-2">Actualmente no hay alertas hidrometeorológicas significativas para la región Litoral. Se recomienda mantenerse informado a través de canales oficiales.</p>
                    <p class="text-sm text-gray-400">Emitida: Hoy, 11:30 AM - Fuente: Instituto Nacional del Agua</p>
                </div>
                 <div class="text-center p-4" id="earlyWarningLoading" style="display:none;"><i class="fas fa-spinner fa-spin fa-2x accent-color"></i><p class="mt-2">Cargando alertas...</p></div>
            </div>
        </div>
    </section>
    
    <section id="preparacion" class="py-16 bg-gray-800 text-white" data-aos="fade-up">
            <div class="container mx-auto px-4">
                <h2 class="text-4xl font-bold text-center mb-12 text-blue-400">Educación y Prevención para Almirante Brown</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-gray-700 p-6 rounded-lg shadow-xl hover:shadow-2xl transition-shadow duration-300">
                        <i class="fas fa-home text-5xl text-yellow-400 mb-4"></i>
                        <h3 class="text-2xl font-semibold mb-3">1. Prepara tu Hogar</h3>
                        <ul class="list-disc list-inside text-gray-300 space-y-2">
                            <li>Limpia canaletas, desagües y alcantarillas.</li>
                            <li>Revisa y sella posibles filtraciones en techos y paredes.</li>
                            <li>Protege documentos importantes en bolsas herméticas y elevadas.</li>
                            <li>Desconecta electrodoméstos si el agua sube.</li>
                            <li>Identifica la ubicación del corte de luz y gas.</li>
                        </ul>
                    </div>

                    <div class="bg-gray-700 p-6 rounded-lg shadow-xl hover:shadow-2xl transition-shadow duration-300">
                        <i class="fas fa-box text-5xl text-red-400 mb-4"></i>
                        <h3 class="text-2xl font-semibold mb-3">2. Arma tu Kit de Emergencia</h3>
                        <ul class="list-disc list-inside text-gray-300 space-y-2">
                            <li>Agua potable (4 litros por persona/día).</li>
                            <li>Alimentos no perecederos.</li>
                            <li>Botiquín de primeros auxilios.</li>
                            <li>Linterna, pilas y radio a pilas.</li>
                            <li>Documentos, medicamentos esenciales.</li>
                            <li>Silbato para pedir ayuda.</li>
                        </ul>
                    </div>

                    <div class="bg-gray-700 p-6 rounded-lg shadow-xl hover:shadow-2xl transition-shadow duration-300">
                        <i class="fas fa-exclamation-triangle text-5xl text-blue-400 mb-4"></i>
                        <h3 class="text-2xl font-semibold mb-3">3. Durante la Inundación</h3>
                        <ul class="list-disc list-inside text-gray-300 space-y-2">
                            <li>No camines por agua en movimiento (solo 15 cm pueden derribarte).</li>
                            <li>Evita el contacto con cables caídos.</li>
                            <li>No toques equipos eléctricos si estás mojado.</li>
                            <li>Dirígete a zonas altas y seguras si es necesario.</li>
                            <li>Sigue las indicaciones de las autoridades.</li>
                        </ul>
                    </div>

                    <div class="bg-gray-700 p-6 rounded-lg shadow-xl hover:shadow-2xl transition-shadow duration-300">
                        <i class="fas fa-phone-alt text-5xl text-green-400 mb-4"></i>
                        <h3 class="text-2xl font-semibold mb-3">4. Contactos de Emergencia (Almirante Brown)</h3>
                        <ul class="list-disc list-inside text-gray-300 space-y-2">
                            <li>Defensa Civil Almirante Brown: <a href="tel:0800-222-2696" class="underline hover:text-green-300">0800-222-2696</a></li>
                            <li>Bomberos Voluntarios (Adrogué): <a href="tel:4214-0000" class="underline hover:text-green-300">4214-0000</a></li>
                            <li>Policía: <a href="tel:911" class="underline hover:text-green-300">911</a></li>
                            <li>Emergencias Médicas (SAME): <a href="tel:107" class="underline hover:text-green-300">107</a></li>
                            <li>Municipio de Almirante Brown: <a href="https://www.brown.gob.ar/" target="_blank" class="underline hover:text-green-300">www.brown.gob.ar</a></li>
                        </ul>
                    </div>

                    <div class="bg-gray-700 p-6 rounded-lg shadow-xl hover:shadow-2xl transition-shadow duration-300">
                        <i class="fas fa-faucet-drip text-5xl text-teal-400 mb-4"></i>
                        <h3 class="text-2xl font-semibold mb-3">5. Después de la Inundación</h3>
                        <ul class="list-disc list-inside text-gray-300 space-y-2">
                            <li>Regresa a casa solo cuando las autoridades lo indiquen.</li>
                            <li>Revisa tu vivienda en busca de daños estructurales.</li>
                            <li>Ventila bien los ambientes para evitar moho.</li>
                            <li>Hierve el agua o usa agua embotellada para consumo.</li>
                            <li>Desecha alimentos y medicamentos que hayan estado en contacto con el agua.</li>
                        </ul>
                    </div>

                    <div class="bg-gray-700 p-6 rounded-lg shadow-xl hover:shadow-2xl transition-shadow duration-300">
                        <i class="fas fa-book-open text-5xl text-purple-400 mb-4"></i>
                        <h3 class="text-2xl font-semibold mb-3">6. Más Recursos y Guías</h3>
                        <ul class="list-disc list-inside text-gray-300 space-y-2">
                            <li>Guías de Defensa Civil Argentina: <a href="https://www.argentina.gob.ar/interior/proteccioncivil" target="_blank" class="underline hover:text-purple-300">argentina.gob.ar/proteccioncivil</a></li>
                            <li>Información del SMN sobre Fenómenos: <a href="https://www.smn.gob.ar/que-hacer-frente-fenomenos" target="_blank" class="underline hover:text-purple-300">smn.gob.ar/que-hacer-frente-fenomenos</a></li>
                            <li>Guía de la Cruz Roja Argentina: <a href="https://www.cruzroja.org.ar/" target="_blank" class="underline hover:text-purple-300">cruzroja.org.ar</a></li>
                            <li>Mantente informado con la App de Alerta Inundaciones IA.</li>
                        </ul>
                    </div>
                </div>
            </div>
     </section>

    <section id="concientizacion" class="py-16 md:py-24 futuristic-bg" data-aos="fade-up">
    <div class="container mx-auto px-4">
        <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Concientización y <span class="accent-color">Red de Ayuda</span></h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center mb-12"> <div class="card p-8" data-aos="zoom-in">
                <h3 class="text-2xl font-semibold mb-4 accent-color"><i class="fas fa-hands-helping mr-2"></i> ¿Cómo Ayudar?</h3>
                <p class="mb-4">Las inundaciones pueden tener consecuencias devastadoras. Tu ayuda puede marcar la diferencia. Considera donar a organizaciones que trabajan en las zonas afectadas o participar como voluntario si es seguro hacerlo.</p>
                <p class="mb-4">Organizaciones recomendadas:</p>
                <ul class="list-disc list-inside mb-4 space-y-1">
                    <li>
                        <a href="https://www.fundacionsi.org.ar/" target="_blank" rel="noopener noreferrer" class="hover:underline accent-color flex items-center">
                            Fundación Sí Argentina
                        </a> - Asistencia en emergencias y proyectos sociales.
                    </li>
                    <li>
                        <a href="https://www.cruzroja.org.ar/" target="_blank" rel="noopener noreferrer" class="hover:underline accent-color flex items-center">
                             Cruz Roja Argentina
                        </a> - Respuesta a desastres y salud comunitaria.
                    </li>
                    <li>
                        <a href="https://www.caritas.org.ar/" target="_blank" rel="noopener noreferrer" class="hover:underline accent-color flex items-center">
                            Cáritas Argentina
                        </a> - Ayuda social y emergencias.
                    </li>
                </ul>
                <a href="https://www.argentina.gob.ar/interior/proteccion-civil/recomendaciones/inundaciones" target="_blank" rel="noopener noreferrer" class="btn-secondary inline-block">Recomendaciones Oficiales</a>
            </div>
            
            <div>
                <img src="https://media.licdn.com/dms/image/v2/C4E12AQHUJBBg4-GBaA/article-cover_image-shrink_720_1280/article-cover_image-shrink_720_1280/0/1647616859291?e=2147483647&v=beta&t=8h0dGHTvawW8A6lKrKUuir4mBchu5uvpZfvATCHCfz0">
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
            <div>
                <img src="https://cdns3.eltiempo.es/eltiempo/blog/noticias/2024/10/25141534/IF-AUTOPROTECCION-INUNDACION-AUTOMOVILES-700x408.png" alt="Señal de nivel de agua alta como prevención" class="rounded-lg shadow-xl w-full h-auto">
                
                </div>

            <div class="card p-8 order-first md:order-last" data-aos="zoom-in"> <h3 class="text-2xl font-semibold mb-4 accent-color"><i class="fas fa-shield-alt mr-2"></i> Medidas de Prevención</h3>
                <ul class="list-disc list-inside space-y-2">
                    <li>Infórmate sobre el riesgo de inundación en tu zona y elabora un plan familiar de emergencia.</li>
                    <li>No arrojes basura a la calle o desagües, esto obstruye el drenaje.</li>
                    <li>Si vives en zona de riesgo, ten a mano una mochila de emergencia con agua, alimentos no perecederos, botiquín, linterna y documentos importantes.</li>
                    <li>Asegura objetos sueltos en patios y balcones que puedan ser arrastrados por el agua o el viento.</li>
                    <li>Desconecta servicios de luz, gas y agua si la inundación es inminente y las autoridades lo indican.</li>
                    <li>Evita transitar por zonas inundadas, ya sea a pie o en vehículo.</li>
                </ul>
            </div>
        </div>
    </div>
</section>

    <section id="contacto" class="py-16 md:py-24">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Formulario de <span class="accent-color">Contacto</span></h2>
            <form id="contactForm" class="max-w-xl mx-auto p-8 card">
                <div class="mb-6">
                    <label for="name" class="block mb-2 text-sm font-medium">Nombre Completo <span class="text-red-500">*</span></label>
                    <input type="text" id="name" name="name" class="shadow-sm" placeholder="Tu Nombre" required>
                </div>
                <div class="mb-6">
                    <label for="email" class="block mb-2 text-sm font-medium">Correo Electrónico <span class="text-red-500">*</span></label>
                    <input type="email" id="email" name="email" class="shadow-sm" placeholder="tuemail@ejemplo.com" required>
                </div>
                <div class="mb-6">
                    <label for="subject" class="block mb-2 text-sm font-medium">Asunto</label>
                    <input type="text" id="subject" name="subject" class="shadow-sm" placeholder="Motivo de tu consulta">
                </div>
                <div class="mb-6">
                    <label for="message" class="block mb-2 text-sm font-medium">Mensaje <span class="text-red-500">*</span></label>
                    <textarea id="message" name="message" rows="4" class="shadow-sm" placeholder="Escribe tu mensaje aquí..." required></textarea>
                </div>
                <button type="submit" class="btn-primary w-full">Enviar Mensaje</button>
                <div id="contactStatus" class="mt-4 text-center"></div>
            </form>
        </div>
    </section>

    <footer class="futuristic-bg py-8 text-center">
        <div class="container mx-auto px-4">
            <p class="mb-2">&copy; <span id="currentYear"></span> AlertaInundaciones.IA - Todos los derechos reservados.</p>
            <p class="text-sm text-gray-400">Una iniciativa para comunidades más seguras y resilientes.</p>
            <div class="mt-4 space-x-4">
                <a href="#" class="hover:accent-color"><i class="fab fa-facebook fa-lg"></i></a>
                <a href="#" class="hover:accent-color"><i class="fab fa-twitter fa-lg"></i></a>
                <a href="#" class="hover:accent-color"><i class="fab fa-instagram fa-lg"></i></a>
            </div>
        </div>
    </footer>

    <div id="messageModal" class="modal">
      <div class="modal-content">
        <span class="close-button" onclick="closeModal()">&times;</span>
        <p id="modalMessageText"></p>
        <button onclick="closeModal()" class="btn-primary mt-4">Entendido</button>
      </div>
    </div>

    <script>
        // Configuration
        const API_BASE_URL = '/api'; // Adjust if your backend runs on a different port
        const USE_MOCK_DATA = false; // Set to false when backend is ready

        // --- Mock Data ---
        const mockFloodZones = {
            frequent: [
                { lat: -34.6037, lng: -58.3816, name: "Zona Peligro Palermo", description: "Área históricamente propensa a inundaciones rápidas." },
                { lat: -34.6158, lng: -58.4333, name: "Cuenca Arroyo Maldonado", description: "Riesgo alto durante lluvias intensas." }
            ],
            reported: [
                { lat: -34.5889, lng: -58.4094, name: "Reporte Av. Libertador", description: "Calle anegada, tránsito complicado.", timestamp: new Date().toISOString() }
            ]
        };

        const mockNews = [
            { title: "Fuertes Lluvias Causan Aniegos en Zona Sur", source: "Noticias Locales", date: new Date().toISOString(), summary: "Varias calles resultaron intransitables tras el temporal de anoche...", link: "#", imageUrl: "https://placehold.co/400x250/1B263B/3DCCC7?text=Noticia+1" },
            { title: "Alerta Meteorológica por Tormentas Intensas", source: "Servicio Meteorológico", date: new Date(Date.now() - 86400000).toISOString(), summary: "Se esperan condiciones adversas para las próximas horas en la región.", link: "#", imageUrl: "https://placehold.co/400x250/1B263B/3DCCC7?text=Noticia+2" },
            { title: "Vecinos de La Boca Preocupados por Sudestada", source: "El Clarín", date: new Date(Date.now() - 172800000).toISOString(), summary: "El aumento del nivel del río podría generar complicaciones.", link: "#", imageUrl: "https://placehold.co/400x250/1B263B/3DCCC7?text=Noticia+3" }
        ];

        const mockWeather = {
            location: "Buenos Aires, AR",
            temperature: 22,
            description: "Parcialmente Nublado",
            feels_like: 21,
            humidity: 75,
            wind_speed: 15,
            pressure: 1012,
            iconUrl: "https://placehold.co/100x100/1B263B/3DCCC7?text=Clima",
            last_updated: new Date().toISOString()
        };
        
        const mockPredictions = [
            // This section is already static in HTML, so mock data here is for future dynamic replacement
            // If you want to replace the static HTML content, uncomment and adapt the fetchPredictions function
        ];
        function getWeatherIcon(description) {
            description = description.toLowerCase(); // Convertir a minúsculas para comparar

            if (description.includes("cielo claro") || description.includes("soleado")) {
                 return '<i class="fas fa-sun text-yellow-400 text-4xl"></i>'; // Sol
            } else if (description.includes("nubes") || description.includes("parcialmente nublado")) {
                 return '<i class="fas fa-cloud-sun text-gray-500 text-4xl"></i>'; // Nubes con sol
            } else if (description.includes("nublado") || description.includes("cubierto")) {
                 return '<i class="fas fa-cloud text-gray-600 text-4xl"></i>'; // Nubes
            } else if (description.includes("lluvia ligera") || description.includes("llovizna")) {
                 return '<i class="fas fa-cloud-showers-heavy text-blue-400 text-4xl"></i>'; // Lluvia ligera
            } else if (description.includes("lluvia moderada") || description.includes("lluvia")) {
                 return '<i class="fas fa-cloud-showers-heavy text-blue-500 text-4xl"></i>'; // Lluvia fuerte
            } else if (description.includes("tormenta") || description.includes("truenos")) {
                 return '<i class="fas fa-bolt text-yellow-500 text-4xl"></i>'; // Tormenta
            } else if (description.includes("nieve") || description.includes("nevada")) {
                 return '<i class="fas fa-snowflake text-blue-200 text-4xl"></i>'; // Nieve
            } else if (description.includes("niebla") || description.includes("neblina")) {
                 return '<i class="fas fa-smog text-gray-400 text-4xl"></i>'; // Niebla
            } else if (description.includes("viento")) {
                 return '<i class="fas fa-wind text-gray-400 text-4xl"></i>'; // Viento
            }
                // Puedes añadir más condiciones aquí para otras descripciones
            return '<i class="fas fa-question-circle text-gray-400 text-4xl"></i>'; // Ícono por defecto
        }

        // Modal functions
        const messageModal = document.getElementById('messageModal');
        const modalMessageText = document.getElementById('modalMessageText');
        function showModal(message, isSuccess = true) {
            modalMessageText.textContent = message;
            modalMessageText.className = isSuccess ? 'text-green-400' : 'text-red-400';
            messageModal.style.display = 'block';
        }
        function closeModal() {
            messageModal.style.display = 'none';
        }
        // Close modal if user clicks outside of it
        window.onclick = function(event) {
            if (event.target == messageModal) {
                closeModal();
            }
        }

        // Smooth scrolling for nav links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth'
                    });
                    document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
                    this.classList.add('active');
                    if(!mobileMenu.classList.contains('hidden')) {
                        mobileMenu.classList.add('hidden');
                    }
                }
            });
        });
        
        // Mobile Menu Toggle
        const mobileMenuButton = document.getElementById('mobileMenuButton');
        const mobileMenu = document.getElementById('mobileMenu');
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Set current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Llamada al cargar la página
         document.addEventListener('DOMContentLoaded', () => {
           fetchAndDisplayFloodZones();  // 👈 Aquí lo activamos
        });
        
        // Fetch News
        async function fetchNews() {
            const newsContainer = document.getElementById('newsContainer');
            const newsLoading = document.getElementById('newsLoading');
            try {
                let newsItems;
                if (USE_MOCK_DATA) {
                    newsItems = mockNews;
                     console.log("Using mock data for news.");
                } else {
                    const response = await fetch(`${API_BASE_URL}/news`);
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    newsItems = await response.json();
                }
                
                newsLoading.style.display = 'none'; 
                newsContainer.innerHTML = ''; 

                if (!newsItems || newsItems.length === 0) {
                    newsContainer.innerHTML = '<p class="text-center col-span-full">No hay noticias disponibles en este momento.</p>';
                    return;
                }

                newsItems.forEach(item => {
                    const newsCard = `
                        <div class="card p-6 transform hover:scale-105 transition-transform duration-300">
                            <img src="${item.imageUrl || 'https://placehold.co/400x250/1B263B/3DCCC7?text=Noticia'}" alt="Imagen de la noticia: ${item.title}" class="rounded-lg mb-4 w-full h-48 object-cover">
                            <h3 class="text-xl font-semibold mb-2 accent-color">${item.title}</h3>
                            <p class="text-sm text-gray-400 mb-1">Fuente: ${item.source} - ${new Date(item.date).toLocaleDateString()}</p>
                            <p class="text-gray-300 mb-3 text-sm">${item.summary}</p>
                            <a href="${item.link}" target="_blank" rel="noopener noreferrer" class="text-sm accent-color hover:underline">Leer más <i class="fas fa-external-link-alt text-xs"></i></a>
                        </div>
                    `;
                    newsContainer.innerHTML += newsCard;
                });
            } catch (error) {
                console.error('Error fetching news:', error);
                newsLoading.style.display = 'none';
                newsContainer.innerHTML = '<p class="text-center col-span-full text-red-400">Error al cargar las noticias. Intente más tarde.</p>';
            }
        }

        async function fetchWeather() {
            const weatherContainer = document.getElementById('weatherContainer');
            const weatherLoading = document.getElementById('weatherLoading');
            
            // Mostrar spinner de carga
            if (weatherLoading) {
                weatherLoading.style.display = 'block';
            }
            weatherContainer.innerHTML = ''; // Limpiar contenido previo

            try {
                const response = await fetch('/api/weather'); // Llama a tu backend Flask
                
                if (!response.ok) {
                    // Si el backend devuelve un error (ej. 500 porque no tiene la API Key), lo manejas aquí
                    const errorData = await response.json().catch(() => ({message: 'Error desconocido del servidor.'}));
                    throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
                }
                const data = await response.json(); // 'data' ahora es directamente el diccionario de weather_data de app.py

                // Ocultar spinner
                if (weatherLoading) {
                    weatherLoading.style.display = 'none';
                }

                // --- Lógica para mostrar el clima actual ---
                // Verifica si la respuesta contiene datos de clima (no hay 'current' ni 'forecast' anidados del backend)
                if (data && data.location && data.temperature !== undefined) { 
                    weatherContainer.innerHTML = `
                        <h3 class="text-2xl font-semibold mb-4 accent-color"><i class="fas fa-cloud-sun mr-2"></i>Clima Actual en ${data.location}</h3>
                        <div class="flex items-center justify-center mb-4">
                            <img src="${data.iconUrl}" alt="${data.description}" class="w-20 h-20">
                            <div>
                                <p class="text-5xl font-bold">${Math.round(data.temperature)}°C</p>
                                <p class="text-lg capitalize">${data.description}</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-sm text-gray-300 max-w-xs mx-auto">
                            <p><i class="fas fa-thermometer-half mr-1"></i> Sens. Térmica: ${Math.round(data.feels_like)}°C</p>
                            <p><i class="fas fa-tint mr-1"></i> Humedad: ${data.humidity}%</p>
                            <p><i class="fas fa-wind mr-1"></i> Viento: ${Math.round(data.wind_speed * 3.6)} km/h</p> <p><i class="fas fa-compass mr-1"></i> Presión: ${data.pressure} hPa</p>
                        </div>
                        <p class="mt-4 text-xs text-gray-400">Última actualización: ${new Date(data.last_updated).toLocaleTimeString('es-AR')}</p>
                    `;
                } else if (data && data.error) { // Si el backend devolvió un error específico
                    weatherContainer.innerHTML = `<p class="text-red-500">Error al cargar el pronóstico: ${data.error}</p>`;
                } else { // Si no hay datos esperados ni un error específico
                     weatherContainer.innerHTML = `<p class="text-yellow-400">No se pudo obtener el pronóstico del tiempo. Intente más tarde.</p>`;
                }

            } catch (error) {
                console.error('Error fetching weather:', error);
                // Ocultar spinner y mostrar mensaje de error
                if (weatherLoading) {
                    weatherLoading.style.display = 'none';
                }
                weatherContainer.innerHTML = '<p class="text-center text-red-400">No se pudo cargar el pronóstico del tiempo. Verifique su conexión o intente más tarde.</p>';
            }
        }
        // Fetch Predictions
        async function fetchPredictions() {
            const predictionsContainer = document.getElementById('predictionsContainer');
            const predictionsLoading = document.getElementById('predictionsLoading');
            predictionsLoading.style.display = 'block'; // Show loading initially

            try {
                let predictions;
                if (USE_MOCK_DATA) {
                    // Since mockPredictions is empty, it will show "no predictions" or keep static.
                    // To actively use mock data to *replace* static, you'd populate mockPredictions.
                    // For now, we let the static content remain if mock data is empty.
                    predictions = mockPredictions; 
                    console.log("Using mock data for predictions (currently empty, static content may remain).");
                } else {
                    const response = await fetch(`${API_BASE_URL}/predictions`);
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    predictions = await response.json();
                }

                // If we have dynamic predictions (either from API or non-empty mock)
                // and want to replace the static ones:
                if (predictions && predictions.length > 0) {
                    predictionsContainer.innerHTML = ''; // Clear static content
                    predictions.forEach(pred => {
                        const predictionCard = `
                            <div class="card p-6">
                                <h3 class="text-xl font-semibold mb-3 accent-color"><i class="fas ${pred.icon || 'fa-brain'} mr-2"></i>${pred.title}</h3>
                                <p class="mb-2">Nivel de Riesgo: <strong class="${pred.riskLevelColor || 'text-gray-300'}">${pred.riskLevel}</strong></p>
                                <p class="mb-2">${pred.details}</p>
                                <p class="text-sm text-gray-400">Válido hasta: ${new Date(pred.validUntil).toLocaleString()}</p>
                                <button onclick="zoomToLocation(map, ${prediction.latitude}, ${prediction.longitude})" class="mt-4 btn-primary py-2 px-4 rounded-md text-sm self-start">Ver en Mapa</button>
                                </div>
                        `;
                        predictionsContainer.insertAdjacentHTML('beforeend', predictionCard);
                    });
                } else if (!USE_MOCK_DATA || (USE_MOCK_DATA && predictions.length === 0 && mockPredictions.length === 0) ) {
                    // If no dynamic predictions and not using mock that would replace,
                    // or if mock data is explicitly empty, we can choose to show a "no predictions" message
                    // or simply let the static content (already in HTML) remain.
                    // For this example, we'll let static content remain if mock is empty.
                    // If you want to show "no predictions available" when API/mock is empty:
                    // predictionsContainer.innerHTML = '<p class="text-center md:col-span-2">No hay predicciones dinámicas disponibles en este momento.</p>';
                }
                 predictionsLoading.style.display = 'none';

            } catch (error) {
                console.error('Error fetching predictions:', error);
                predictionsLoading.style.display = 'none'; // Hide loading, static content remains
                // Optionally show an error message in the container:
                // predictionsContainer.innerHTML = '<p class="text-center md:col-span-2 text-red-400">Error al cargar las predicciones.</p>';
            }
        }
        
        // Fetch Early Warnings (ahora desde SMN RSS)
        async function fetchEarlyWarnings() {
            const warningsContainer = document.getElementById('earlyWarningsContainer');
            warningsContainer.innerHTML = '<p class="text-center text-gray-400">Cargando alertas...</p>';
            try {
                // Llama a tu backend para obtener las alertas del SMN
                const response = await fetch('/api/smn_alerts'); 
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ message: 'Error desconocido del servidor.' }));
                    throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
                }
                const warnings = await response.json();

                if (warnings.length > 0) {
                    warningsContainer.innerHTML = warnings.map(warning => {
                        let warningColor = 'bg-blue-600'; // Default para alertas
                        if (warning.alert_level && warning.alert_level.toLowerCase().includes('amarillo')) {
                            warningColor = 'bg-yellow-600';
                        } else if (warning.alert_level && warning.alert_level.toLowerCase().includes('naranja')) {
                            warningColor = 'bg-orange-600';
                        } else if (warning.alert_level && warning.alert_level.toLowerCase().includes('rojo')) {
                            warningColor = 'bg-red-600';
                        }
                        
                        const publishedDate = warning.published ? new Date(warning.published * 1000).toLocaleDateString('es-AR', { hour: '2-digit', minute: '2-digit' }) : 'Fecha desconocida';

                        return `
                            <div class="card p-4 mb-3 ${warningColor} bg-opacity-70 text-white rounded-lg shadow-md" data-aos="fade-up">
                                <h3 class="text-lg font-bold mb-1">${warning.title}</h3>
                                <p class="text-sm italic">${warning.location_name} - ${publishedDate}</p>
                                <p class="text-sm mt-2">${warning.summary}</p>
                                <a href="${warning.link}" target="_blank" rel="noopener noreferrer" class="text-xs underline mt-2 block hover:text-gray-200">Ver detalles en SMN</a>
                                ${warning.latitude && warning.longitude ? `<button onclick="zoomToLocation(${warning.latitude}, ${warning.longitude})" class="mt-2 btn-secondary py-1 px-3 rounded-md text-xs">Ver en Mapa</button>` : ''}
                            </div>
                        `;
                    }).join('');
                } else {
                    warningsContainer.innerHTML = '<p class="text-center text-gray-400">No hay alertas tempranas activas para Almirante Brown y alrededores en este momento.</p>';
                }
            } catch (error) {
                console.error('Error fetching early warnings:', error);
                warningsContainer.innerHTML = '<p class="text-center text-red-400">Error al cargar las alertas tempranas. Intente más tarde.</p>';
            }
        }

        // Handle Flood Report Form Submission
        const floodReportForm = document.getElementById('floodReportForm');
        const reportStatus = document.getElementById('reportStatus');

    
    let map;
    let autocomplete; // Declara autocomplete globalmente
    let infoWindow; // Para mostrar información de marcadores
    let reportMap;      // <-- Añadir esta línea
    let reportMarker;   // <-- Añadir esta línea
    let floodZoneMarkers = []; // Para tus marcadores de reportes y zonas frecuentes
    let smnAlertMarkers = [];  // Para los nuevos marcadores de alertas del SMN
    
    // **NUEVAS DECLARACIONES GLOBALES EXPLÍCITAS**
    window.floodZoneMarkers = []; // Para tus marcadores de reportes y zonas frecuentes
    window.smnAlertMarkers = [];  // Para los nuevos marcadores de alertas del SMN
    
     function initMap() {
        const defaultLocation = { lat: -34.8090, lng: -58.4060 }; // Almirante Brown

        // --- 1. Inicialización del MAPA PRINCIPAL de Alertas (sin cambios) ---
        map = new google.maps.Map(document.getElementById("map"), {
            center: defaultLocation,
            zoom: 12,
            mapId: 'MAIN_MAP_STYLE' // Un ID para posibles estilos futuros
        });
        infoWindow = new google.maps.InfoWindow();
        fetchAndDisplayFloodZones(); // Carga los marcadores de alerta en el mapa principal

        // --- 2. Inicialización del SEGUNDO MAPA en el formulario de reporte ---
        reportMap = new google.maps.Map(document.getElementById("reportMap"), {
            center: defaultLocation,
            zoom: 12,
            mapId: 'REPORT_MAP_STYLE'
        });

        // --- 3. Creación de un MARCADOR MÓVIL para el mapa de reporte ---
        reportMarker = new google.maps.Marker({
            position: defaultLocation,
            map: reportMap,
            draggable: true, // Permite que el usuario lo arrastre
            title: "Arrastra para ajustar la ubicación del reporte"
        });

        // --- 4. Conexión del AUTOCOMPLETADO con el mapa de reporte ---
        const addressInput = document.getElementById("reportLocationInput");
        autocomplete = new google.maps.places.Autocomplete(addressInput, {
            types: ["address"],
            componentRestrictions: { country: "ar" },
        });

        autocomplete.addListener("place_changed", () => {
            const place = autocomplete.getPlace();
            if (!place.geometry || !place.geometry.location) {
                window.alert("No se encontraron detalles para la dirección: '" + place.name + "'");
                return;
            }

            // Mueve el mapa y el marcador a la dirección seleccionada
            reportMap.setCenter(place.geometry.location);
            reportMap.setZoom(17);
            reportMarker.setPosition(place.geometry.location);

            // Actualiza los campos ocultos del formulario
            document.getElementById('reportLat').value = place.geometry.location.lat();
            document.getElementById('reportLng').value = place.geometry.location.lng();
        });

        // --- 5. Lógica para actualizar los campos al interactuar con el mapa ---

        // Evento si el usuario hace clic en el mapa para mover el marcador
        reportMap.addListener("click", (e) => {
            reportMarker.setPosition(e.latLng);
            document.getElementById('reportLat').value = e.latLng.lat();
            document.getElementById('reportLng').value = e.latLng.lng();
        });

        // Evento cuando el usuario termina de arrastrar el marcador
        reportMarker.addListener('dragend', (e) => {
            document.getElementById('reportLat').value = e.latLng.lat();
            document.getElementById('reportLng').value = e.latLng.lng();
        });
    }
    
    // Función para centrar el mapa en una ubicación específica
    // **NOTA: AHORA RECIBE 'mapInstance' COMO ARGUMENTO**
    function zoomToLocation(mapInstance, lat, lng) {
        if (mapInstance) { // Asegúrate de que la instancia del mapa exista
            const location = { lat: lat, lng: lng };
            mapInstance.setCenter(location);
            mapInstance.setZoom(14); // Ajusta el zoom para que se vea bien la ubicación

            // Opcional: añadir un marcador temporal o resaltar la ubicación
            const tempMarker = new google.maps.Marker({
                position: location,
                map: mapInstance, // Usa mapInstance
                title: 'Ubicación de Alerta/Predicción',
                animation: google.maps.Animation.DROP // Efecto visual
            });

            // Eliminar el marcador temporal después de unos segundos
            setTimeout(() => {
                tempMarker.setMap(null);
            }, 5000); // Se elimina después de 5 segundos

            // Scrolls to the map section if not already visible
            document.getElementById('mapa').scrollIntoView({ behavior: 'smooth' });
        } else {
            console.warn('Instancia del mapa no proporcionada para zoomToLocation.');
        }
    }

    // ... (Mantén tus otras funciones como fetchNews, fetchWeather, etc.) ...

    // --- Formulario de Reporte de Inundación ---
        const floodStatus = document.getElementById("reportStatus");

    // Asegúrate de que estos campos ocultos existan en tu formulario HTML
    // <input type="hidden" id="flood-lat" name="lat">
    // <input type="hidden" id="flood-lng" name="lng">

    floodReportForm.addEventListener('submit', async function(event) {
        event.preventDefault(); // Evitar el envío por defecto del formulario
        reportStatus.innerHTML = 'Enviando reporte...';
        reportStatus.className = 'text-blue-600'; // Estilo de carga

        try {
            const formData = new FormData(this); // Captura todos los datos del formulario

            // Asegúrate de que lat y lng tengan valores válidos antes de enviar
            const lat = formData.get('lat');
            const lng = formData.get('lng');
            if (!lat || !lng || isNaN(parseFloat(lat)) || isNaN(parseFloat(lng))) {
                throw new Error('Por favor, selecciona una ubicación en el mapa o usa el autocompletado.');
            }

            const response = await fetch(`${API_BASE_URL}/flood-reports`, { // URL corregida
                method: 'POST',
                body: formData, // FormData se encarga de multipart/form-data automáticamente
            });

            if (!response.ok) {
                const errorData = await response.json().catch(() => ({ message: 'Error desconocido al procesar la respuesta del servidor.' }));
                throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
            }

            const result = await response.json();
            showModal(result.message || 'Reporte enviado con éxito.', true);
            floodReportForm.reset(); // Limpia el formulario
            reportStatus.innerHTML = ''; // Limpia el mensaje de estado

            // Después de un reporte exitoso, refresca los marcadores del mapa
            fetchAndDisplayFloodZones();

        } catch (error) {
            console.error('Error al enviar el reporte de inundación:', error);
            showModal(`Error al enviar el reporte: ${error.message}`, false);
            reportStatus.innerHTML = '';
        }
    });


    // --- Funciones para cargar y mostrar datos ---

    async function fetchAndDisplayFloodZones() {
        console.log("Fetching flood zones and SMN alerts...");
        // Asegúrate de que el mapa esté inicializado antes de intentar agregar marcadores
        if (!map) {
            console.warn("El mapa de Google Maps aún no está inicializado. Reintentando en breve...");
            setTimeout(fetchAndDisplayFloodZones, 500); // Reintentar después de 500ms
            return;
        }

        // Eliminar marcadores existentes antes de agregar los nuevos
        if (window.floodZoneMarkers) {
            for (let i = 0; i < window.floodZoneMarkers.length; i++) {
                window.floodZoneMarkers[i].setMap(null);
            }
        }
        window.floodZoneMarkers = []; // Reinicia el array de marcadores para reportes y zonas frecuentes

        // NUEVO: Array para los marcadores de alertas del SMN
        if (window.smnAlertMarkers) {
            for (let i = 0; i < window.smnAlertMarkers.length; i++) {
                window.smnAlertMarkers[i].setMap(null);
            }
        }
        window.smnAlertMarkers = []; // Reinicia el array de marcadores para alertas SMN

        try {
            // --- 1. Obtener Zonas de Inundación y Reportes Ciudadanos ---
            const floodResponse = await fetch(`${API_BASE_URL}/flood-zones`);
            if (!floodResponse.ok) {
                throw new Error(`HTTP error! status: ${floodResponse.status}`);
            }
            const floodData = await floodResponse.json();
            console.log("Flood zones data:", floodData);

            // Iconos personalizados para Google Maps (opcional, si los tienes locales)
            // Asegúrate de que estas URLs de iconos sean válidas o reemplázalas por tus propias imágenes
            const frequentIcon = {
                url: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png', // Rojo: zona frecuente
                scaledSize: new google.maps.Size(32, 32)
            };
            const reportedIcon = {
                url: 'http://maps.google.com/mapfiles/ms/icons/yellow-dot.png', // Amarillo: reporte ciudadano
                scaledSize: new google.maps.Size(32, 32)
            };
            const smnAlertIcon = {
                url: 'http://maps.google.com/mapfiles/ms/icons/orange-dot.png', // Naranja: alerta SMN
                scaledSize: new google.maps.Size(32, 32)
            };


            // Mostrar zonas de inundación frecuentes
            floodData.frequent.forEach(zone => {
                const marker = new google.maps.Marker({
                    position: { lat: zone.lat, lng: zone.lng },
                    map: map, // Asegúrate de que 'map' sea tu mapa principal
                    icon: frequentIcon,
                    title: `Zona Frecuente: ${zone.description}`
                });

                const contentString = `
                    <div class="info-window-content bg-gray-700 text-white p-2 rounded-md">
                        <h3 class="font-bold text-lg mb-1">Zona de Inundación Frecuente</h3>
                        <p class="text-sm">${zone.description}</p>
                        <p class="text-xs text-gray-400">Última actualización: ${new Date(zone.updated_at).toLocaleString('es-AR')}</p>
                    </div>
                `;

                marker.addListener("click", () => {
                    infoWindow.setContent(contentString);
                    infoWindow.open(map, marker);
                });
                window.floodZoneMarkers.push(marker);
            });

            // Mostrar reportes ciudadanos (individuales)
            floodData.reported.forEach(report => {
                const marker = new google.maps.Marker({
                    position: { lat: report.lat, lng: report.lng },
                    map: map, // Asegúrate de que 'map' sea tu mapa principal
                    icon: reportedIcon,
                    title: `Reporte Ciudadano: ${report.address}`
                });

                const contentString = `
                    <div class="info-window-content bg-gray-700 text-white p-2 rounded-md">
                        <h3 class="font-bold text-lg mb-1">Reporte de Inundación Ciudadano</h3>
                        <p class="text-sm"><strong>Dirección:</strong> ${report.address}</p>
                        <p class="text-sm"><strong>Descripción:</strong> ${report.description}</p>
                        <p class="text-xs text-gray-400"><strong>Fecha/Hora:</strong> ${new Date(report.timestamp).toLocaleString('es-AR')}</p>
                        ${report.image_url ? `<img src="${report.image_url}" alt="Evidencia" class="mt-2 w-32 h-auto object-cover rounded-md">` : ''}
                    </div>
                `;

                marker.addListener("click", () => {
                    infoWindow.setContent(contentString);
                    infoWindow.open(map, marker);
                });
                window.floodZoneMarkers.push(marker);
            });

            // --- 2. Obtener y mostrar Alertas del SMN ---
            // Usa la misma API que ya llamas en fetchEarlyWarnings, pero aquí para el mapa
            const smnAlertsResponse = await fetch('/api/smn_alerts'); 
            if (!smnAlertsResponse.ok) {
                const errorData = await smnAlertsResponse.json().catch(() => ({ message: 'Error desconocido al obtener alertas SMN.' }));
                throw new Error(errorData.message || `HTTP error! status: ${smnAlertsResponse.status}`);
            }
            const smnAlerts = await smnAlertsResponse.json();
            console.log("SMN Alerts data:", smnAlerts);

            smnAlerts.forEach(alert => {
                // Solo añadir marcador si tiene latitud y longitud
                if (alert.latitude && alert.longitude) {
                    const marker = new google.maps.Marker({
                        position: { lat: alert.latitude, lng: alert.longitude },
                        map: map, // Asegúrate de que 'map' sea tu mapa principal
                        icon: smnAlertIcon,
                        title: `Alerta SMN: ${alert.title}`
                    });

                    const publishedDate = alert.published ? new Date(alert.published * 1000).toLocaleString('es-AR') : 'Fecha desconocida';
                    const contentString = `
                        <div class="info-window-content bg-gray-700 text-white p-2 rounded-md">
                            <h3 class="font-bold text-lg mb-1">Alerta SMN: ${alert.title}</h3>
                            <p class="text-sm italic">Ubicación: ${alert.location_name}</p>
                            <p class="text-xs text-gray-400">Publicado: ${publishedDate}</p>
                            <p class="text-sm mt-2">${alert.summary}</p>
                            <a href="${alert.link}" target="_blank" rel="noopener noreferrer" class="text-xs underline mt-2 block hover:text-gray-200">Ver detalles en SMN</a>
                        </div>
                    `;

                    marker.addListener("click", () => {
                        infoWindow.setContent(contentString);
                        infoWindow.open(map, marker);
                    });
                    window.smnAlertMarkers.push(marker); // Guarda el marcador en el nuevo array
                }
            });

        } catch (error) {
            console.error("Error al obtener datos para el mapa:", error);
            // Podrías mostrar un mensaje en el mapa o en un div específico
        }
    }

        // Handle Contact Form Submission
        const contactForm = document.getElementById('contactForm');
        const contactStatus = document.getElementById('contactStatus');
        contactForm.addEventListener('submit', async function(event) {
            event.preventDefault();
            contactStatus.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando mensaje...';
            contactStatus.className = 'mt-4 text-center text-yellow-400';

            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());

            if (USE_MOCK_DATA) {
                setTimeout(() => { // Simulate network delay
                    console.log("Mock contact form submitted:", data);
                    showModal('Mensaje (simulado) enviado con éxito. Nos pondremos en contacto pronto.', true);
                    contactForm.reset();
                    contactStatus.innerHTML = '';
                }, 1000);
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/contact`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                if (!response.ok) {
                     const errorData = await response.json().catch(() => ({message: 'Error desconocido al procesar la respuesta del servidor.'}));
                    throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
                }

                // const result = await response.json(); // Assuming backend sends JSON back
                showModal('Mensaje enviado con éxito. Nos pondremos en contacto pronto.', true);
                contactForm.reset();
                contactStatus.innerHTML = '';

            } catch (error) {
                console.error('Error submitting contact form:', error);
                showModal(`Error al enviar el mensaje: ${error.message}`, false);
                contactStatus.innerHTML = '';
            }
        });
        // Carga inicial de datos cuando el DOM esté listo (pero NO el mapa)
        document.addEventListener('DOMContentLoaded', () => {
            AOS.init(); // Asegúrate de que AOS.init() se llame aquí
            fetchNews();
            fetchPredictions();
            fetchEarlyWarnings();
            fetchWeather();
            // NOTA: fetchAndDisplayFloodReports() ahora se llama desde initMap()
        });
    </script>
     <!-- Google Maps API (carga al final) -->
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAHAQEUMTr_Pg-DQvW9M__vNnzubYFzSNM&libraries=places&callback=initMap"
    async
    defer
  ></script>
</body>
</html>